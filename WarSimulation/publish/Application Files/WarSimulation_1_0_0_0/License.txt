This code is written by Hatef Shamshiri